<?xml version="1.0" encoding="UTF-8"?>
<!--Sample XML file generated by XMLSpy v2006 sp2 U (http://www.altova.com)-->
<Spider xmlns="http://fox.spider.configuration" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://fox.spider.configuration
../SpiderConf.xsd" id="PCHome_eBay" name="">
	<Table id="UrlTable" name="">
		<Column type="string" name="url"/>
	</Table>
	<Table id="ItemTable" name="ItemTable">
		<Column type="string" name="Source"/>
		<Column type="string" name="Category"/>
		<Column type="string" name="Url"/>
		<Column type="string" name="ItemId"/>
		<Column type="string" name="Title"/>
		<Column type="string" name="ThumbnailUrl"/>	
		<Column type="string" name="Seller"/>
		<Column type="string" name="SellerGrade"/>
		<Column type="string" name="Price"/>
		<Column type="string" name="NumberOfItems"/>
		<Column type="string" name="StartingPrice"/>
		<Column type="string" name="SatisfiedPrice"/>
		<Column type="string" name="BidCount"/>
		<Column type="string" name="ItemStatus"/>
		<Column type="string" name="ItemLocation"/>
		<Column type="string" name="StartDate"/>
		<Column type="string" name="EndDate"/>
		<Column type="string" name="ShippingFee"/>
		<Column type="string" name="BidInfos"/>
	</Table>
	<PageTurners starter="CategoryPager">
		<LinkedWebPageTurner id="CategoryNextPage" name="" delay="400">
			<UrlPattern>http://class.ruten.com.tw/category/sub(_j\.php)?\?[0-9A-Za-z]+.*</UrlPattern>
			<Path>/BODY/DIV[1]/TABLE[0]/TBODY[0]/TR[1]/TD[0]/DIV[0]/{last-child}/A[0]</Path>
		</LinkedWebPageTurner>
		<UrlWebPageTurner id="CategoryPager" name="">
			<url>http://class.ruten.com.tw/category/sub\?0019000200020001</url>
			<url>http://class.ruten.com.tw/category/sub\?0019000200020004</url>
		</UrlWebPageTurner>
		<DataTableWebPageTurner id="DetailItemPager" name="" delay="1000">
			<DataTable>UrlTable</DataTable>
			<Field>url</Field>
		</DataTableWebPageTurner>
	</PageTurners>
	<SpiderFlow id="UrlParsingFlow" name="">
		<UrlPattern>http://class.ruten.com.tw/category/sub?[0-9A-Za-z]+.*</UrlPattern>
		<DocumentParsers>
			<TableDocumentParser id="UrlCollector" table="UrlTable" name="" >
				<RowContentParserId>UrlParser</RowContentParserId>
				<Path>/BODY/DIV[1]/TABLE[2]</Path>
				<StartRow>1</StartRow>
			</TableDocumentParser>
		</DocumentParsers>
		<RowContentParsers>
			<AttributeRowContentParser id="UrlParser" name="">
				<Path>TD[1]/STRONG[0]/A[0]</Path>
				<Attribute>HREF</Attribute>
				<ColumnName>url</ColumnName>
			</AttributeRowContentParser>
		</RowContentParsers>
		<RowFilters>
			<ValueFilter id="NullUrl" docparser="UrlCollector" name="">
				<Constraint FieldName="url">
					<NotNull/>
				</Constraint>
			</ValueFilter>
		</RowFilters>
	</SpiderFlow>
	<SpiderFlow id="DetailParsingFlow" name="">
		<UrlPattern>http://goods.ruten.com.tw/item/show\?[0-9A-Za-z]+</UrlPattern>
		<DocumentParsers>
			<RepeaterDocumentParser id="DummyRepeater" table="ItemTable" name="">
				<RowContentParserId>ItemValueParser</RowContentParserId>
				<Path>
					<FirstPath>/BODY/CENTER[0]</FirstPath>
					<NextPath>NULL[0]</NextPath>
				</Path>
			</RepeaterDocumentParser>
		</DocumentParsers>
		<RowContentParsers>
			<XPathRowContentParser id="ItemValueParser" name="">
				<Pair>
					<Path>TABLE[0]</Path>
					<ColumnName>Category</ColumnName>
				</Pair>
				<Pair>
					<Path>TABLE[1]/FORM[0]/TBODY[0]/TR[1]/TD[0]</Path>
					<ColumnName>Title</ColumnName>
				</Pair>
				<Pair>
					<Path>TABLE[1]/FORM[0]/TBODY[0]/TR[11]/TD[0]</Path>
					<ColumnName>BidInfos</ColumnName>
				</Pair>
				<Pair>
					<Path>TABLE[1]/FORM[0]/TBODY[0]/TR[7]/TD[0]/TABLE[0]/TBODY[0]/TR[0]/TD[1]/TABLE[0]/TBODY[0]/TR[7]/TD[0]/TABLE[0]/TBODY[0]/TR[0]/TD[0]/A[0]</Path>
					<ColumnName>Seller</ColumnName>
				</Pair>
				<Pair>
					<Path>TABLE[1]/FORM[0]/TBODY[0]/TR[7]/TD[0]/TABLE[0]/TBODY[0]/TR[0]/TD[1]/TABLE[0]/TBODY[0]/TR[7]/TD[0]/TABLE[0]/TBODY[0]/TR[0]/TD[0]/A[1]</Path>
					<ColumnName>SellerGrade</ColumnName>
				</Pair>
			</XPathRowContentParser>
			<RegexRowContentParser id="RegexParser" name="">
				<Path>TABLE[1]/FORM[0]/TBODY[0]/TR[1]/TD[1]</Path>
				<Pair>
					<Regex>([0-9a-zA-Z]+)</Regex>
					<ColumnName>ItemId</ColumnName>
				</Pair>
			</RegexRowContentParser>
			<RegexRowContentParser id="ItemStatusParser" name="">
				<Path>TABLE[1]/FORM[0]/TBODY[0]/TR[7]/TD[0]/TABLE[0]/TBODY[0]/TR[0]/TD[0]/TABLE[0]/TBODY[0]/TR[0]/TD[1]/TABLE[0]/TBODY[0]/TR[5]/TD[0]/TABLE[0]/TBODY[0]/TR[0]/TD[0]</Path>
				<Pair>
					<Regex>物品狀況：([^\r\n]+)</Regex>
					<ColumnName>ItemStatus</ColumnName>
				</Pair>
			</RegexRowContentParser>
			<AttributeRowContentParser id="ThumbnailParser" name="">
				<Path>TABLE[1]/FORM[0]/TBODY[0]/TR[7]/TD[0]/TABLE[0]/TBODY[0]/TR[0]/TD[0]/TABLE[0]/TBODY[0]/TR[0]/TD[0]/TABLE[0]/TBODY[0]/TR[0]/TD[0]/DIV[0]/A[0]/IMG[0]</Path>
				<Attribute>SRC</Attribute>
				<ColumnName>ThumbnailUrl</ColumnName>
			</AttributeRowContentParser>
			<ConstantsRowContentParser id="DetailItemUrlParser" name="">
				<Field>Url</Field>
				<Type>URL</Type>
			</ConstantsRowContentParser>
			<ConstantsRowContentParser id="SourceParser" name="">
				<Field>Source</Field>
				<Type>any</Type>
				<DefaultValue>Pchome &amp; eBay</DefaultValue>
			</ConstantsRowContentParser>
			<RepeaterRowContentParser id="PriceParser" name="">
				<Path>
					<FirstPath>TABLE[1]/FORM[0]/TBODY[0]/TR[7]/TD[0]/TABLE[0]/TBODY[0]/TR[0]/TD[0]/TABLE[0]/TBODY[0]/TR[0]/TD[1]/TABLE[0]/TBODY[0]/TR[0]/TD[0]/TABLE[0]/TBODY[0]/TR[0]</FirstPath>
					<NextPath>{following-sibling:TR}</NextPath>
				</Path>
				<ParsingInfo>
					<Column>StartingPrice</Column>
					<MatcherPath>TD[0]</MatcherPath>
					<MatcherRegex>開始價格</MatcherRegex>
					<ValuePath>{following-sibling:TD}</ValuePath>
					<ValueRegex>([0-9,]+)</ValueRegex>
				</ParsingInfo>
				<ParsingInfo>
					<Column>Price</Column>
					<MatcherPath>TD[0]</MatcherPath>
					<MatcherRegex>開始價格</MatcherRegex>
					<ValuePath>{following-sibling:TD}</ValuePath>
					<ValueRegex>([0-9,]+)</ValueRegex>
				</ParsingInfo>
				<ParsingInfo>
					<Column>Price</Column>
					<MatcherPath>TD[0]</MatcherPath>
					<MatcherRegex>目前出價</MatcherRegex>
					<ValuePath>{following-sibling:TD}</ValuePath>
					<ValueRegex>([0-9,]+)</ValueRegex>
				</ParsingInfo>
				<ParsingInfo>
					<Column>SatisfiedPrice</Column>
					<MatcherPath>TD[0]</MatcherPath>
					<MatcherRegex>直接購買價</MatcherRegex>
					<ValuePath>{following-sibling:TD}</ValuePath>
					<ValueRegex>([0-9,]+)</ValueRegex>
				</ParsingInfo>
			</RepeaterRowContentParser>
			<RepeaterRowContentParser id="DetailItemParser2" name="">
				<Path>
					<FirstPath>TABLE[1]/FORM[0]/TBODY[0]/TR[7]/TD[0]/TABLE[0]/TBODY[0]/TR[0]/TD[0]/TABLE[0]/TBODY[0]/TR[0]/TD[1]/TABLE[0]/TBODY[0]/TR[3]/TD[0]/TABLE[0]/TBODY[0]/TR[0]</FirstPath>
					<NextPath>{following-sibling:TR}</NextPath>
				</Path>
				<ParsingInfo>
					<Column>StartDate</Column>
					<MatcherPath>TD[0]</MatcherPath>
					<MatcherRegex>\s</MatcherRegex>
					<ValuePath>{following-sibling:TD}</ValuePath>
					<ValueRegex>([0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2}) ~</ValueRegex>
				</ParsingInfo>
				<ParsingInfo>
					<Column>EndDate</Column>
					<MatcherPath>TD[0]</MatcherPath>
					<MatcherRegex>\s</MatcherRegex>
					<ValuePath>{following-sibling:TD}</ValuePath>
					<ValueRegex> ~ ([0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2})</ValueRegex>
				</ParsingInfo>
				<ParsingInfo>
					<Column>NumberOfItems</Column>
					<MatcherPath>TD[0]</MatcherPath>
					<MatcherRegex>商品數量</MatcherRegex>
					<ValuePath>{following-sibling:TD}</ValuePath>
					<ValueRegex>([0-9,]+)</ValueRegex>
				</ParsingInfo>
				<ParsingInfo>
					<Column>BidCount</Column>
					<MatcherPath>TD[0]</MatcherPath>
					<MatcherRegex>出價次數</MatcherRegex>
					<ValuePath>{following-sibling:TD}</ValuePath>
					<ValueRegex>([0-9,]+)</ValueRegex>
				</ParsingInfo>
				<ParsingInfo>
					<Column>ShippingFee</Column>
					<MatcherPath>TD[0]</MatcherPath>
					<MatcherRegex>運費</MatcherRegex>
					<ValuePath>{following-sibling:TD}</ValuePath>
				</ParsingInfo>
				<ParsingInfo>
					<Column>ItemLocation</Column>
					<MatcherPath>TD[0]</MatcherPath>
					<MatcherRegex>物品所在地</MatcherRegex>
					<ValuePath>{following-sibling:TD}</ValuePath>
				</ParsingInfo>
			</RepeaterRowContentParser>
			
		</RowContentParsers>
	</SpiderFlow>
</Spider>
